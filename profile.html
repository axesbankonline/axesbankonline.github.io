<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Axes Bank</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="topbar">
        <div class="logo-container">
            <img src="https://via.placeholder.com/50" alt="Bank Logo" class="logo-img">
            <span class="bank-name">Axes Bank</span>
        </div>
        <div class="nav-buttons">
            <button class="nav-button" onclick="window.location.href='dashboard.html'">Dashboard</button>
            <button class="nav-button" onclick="window.location.href='settings.html'">Settings</button>
            <button class="nav-button" id="logoutButton">Logout</button>
        </div>
    </div>

    <div class="container">
        <div class="profile-info">
            <div class="info-item">
                <div class="info-label">Full Name</div>
                <div class="info-value" id="userName">Loading...</div>
            </div>

            <div class="info-item">
                <div class="info-label">Credit Number</div>
                <div class="info-value" id="credNumber">Loading...</div>
            </div>

            <div class="info-item">
                <div class="info-label">Password</div>
                <div class="info-value">
                    <input type="password" id="password" class="password-input" readonly>
                    <span class="toggle-password" onclick="togglePassword()">üëÅÔ∏è</span>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Import Firebase modules
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/11.3.1/firebase-database.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBjkyVHbax09W9viyKmBH-MXQXqyfizJws",
            authDomain: "bankdata-fe769.firebaseapp.com",
            databaseURL: "https://bankdata-fe769-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "bankdata-fe769",
            storageBucket: "bankdata-fe769.appspot.com",
            messagingSenderId: "967507656753",
            appId: "1:967507656753:web:562c1383dca78d56471510",
            measurementId: "G-9E5XE77RVB"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

function loadProfile() {
    const userId = localStorage.getItem("loggedInUser");
    
    if (!userId) {
        console.warn("No logged-in user found. Redirecting...");
        window.location.href = "index.html";
        return;
    }

    const userRef = ref(database, `users/${userId}`);
    get(userRef).then((snapshot) => {
        if (snapshot.exists()) {
            const userData = snapshot.val();
            console.log("User found:", userData);

            document.getElementById("userName").textContent = userData.name;
            document.getElementById("credNumber").textContent = userId;
            document.getElementById("password").value = userData.password;
        } else {
            console.warn("User data not found. Redirecting...");
            window.location.href = "index.html";
        }
    }).catch(error => {
        console.error("Error loading profile:", error);
        window.location.href = "index.html";
    });
}


        function togglePassword() {
            const passwordField = document.getElementById("password");
            passwordField.type = passwordField.type === "password" ? "text" : "password";
        }

        // Logout Function
        document.getElementById("logoutButton").addEventListener("click", () => {
            localStorage.removeItem("userId");
            window.location.href = "index.html";
        });

        // Load Profile on Page Load
        window.onload = loadProfile;
    </script>
</body>
</html>
